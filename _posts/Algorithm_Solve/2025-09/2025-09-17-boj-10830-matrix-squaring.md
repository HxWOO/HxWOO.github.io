---
layout: post
title: "[BOJ] 10830 - í–‰ë ¬ ì œê³±"
date: 2025-09-17 00:00:00 +0900
categories: [Algorithm_Solve]
tags: [divide-and-conquer, math, linear-algebra]
---

<br>

### ğŸ’» ë°±ì¤€ 10830ë²ˆ: í–‰ë ¬ ì œê³±

- **ë¬¸ì œ ë§í¬:** [https://www.acmicpc.net/problem/10830](https://www.acmicpc.net/problem/10830)
- **ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜:** ë¶„í•  ì •ë³µì„ ì´ìš©í•œ ê±°ë“­ì œê³±, ìˆ˜í•™

## ë¬¸ì œ ì†Œê°œ ğŸ§

í¬ê¸°ê°€ N*Nì¸ í–‰ë ¬ Aì™€ ê±°ë“­ì œê³±í•  íšŸìˆ˜ Bê°€ ì£¼ì–´ì§ˆ ë•Œ, Aì˜ Bì œê³±ì„ êµ¬í•˜ëŠ” ë¬¸ì œë‹¤. Bê°€ ìµœëŒ€ 1000ì–µê¹Œì§€ ê°€ëŠ¥í•˜ë¯€ë¡œ, ë‹¨ìˆœ ë°˜ë³µìœ¼ë¡œëŠ” í•´ê²°í•  ìˆ˜ ì—†ê³  íš¨ìœ¨ì ì¸ ê±°ë“­ì œê³± ì•Œê³ ë¦¬ì¦˜ì´ í•„ìš”í•˜ë‹¤.

### ì…ë ¥ ğŸ“

- ì²«ì§¸ ì¤„: í–‰ë ¬ì˜ í¬ê¸° N (2 â‰¤ N â‰¤ 5)ê³¼ ì§€ìˆ˜ B (1 â‰¤ B â‰¤ 100,000,000,000)
- ë‘˜ì§¸ ì¤„ë¶€í„° Nê°œì˜ ì¤„: í–‰ë ¬ Aì˜ ì›ì†Œ (0 ì´ìƒ 1,000 ì´í•˜ì˜ ì •ìˆ˜)

### ì¶œë ¥ ğŸ“¤

- í–‰ë ¬ Aë¥¼ Bì œê³±í•œ ê²°ê³¼ì˜ ê° ì›ì†Œë¥¼ 1,000ìœ¼ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤.

---

### í’€ì´: ë¶„í•  ì •ë³µì„ ì´ìš©í•œ í–‰ë ¬ ê±°ë“­ì œê³± ğŸš€

#### Idea 1: ë‹¨ìˆœ ë°˜ë³µ

ê°€ì¥ ë¨¼ì € ìƒê°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ Bë²ˆ ë§Œí¼ í–‰ë ¬ ê³±ì…ˆì„ ë°˜ë³µí•˜ëŠ” ê²ƒì´ë‹¤. í–‰ë ¬ì˜ í¬ê¸° Nì´ 5ë¡œ ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— í˜¹ì‹œ ê°€ëŠ¥í•˜ì§€ ì•Šì„ê¹Œ ìƒê°í–ˆë‹¤.

#### Code 1

```python
import sys

n, b = map(int, sys.stdin.readline().split())
mat = [list(map(int, sys.stdin.readline().split())) for _ in range(n)]

def pow_mat(matrix:list[list], n, b):

    new_mat = [row[:] for row in matrix]
    for _ in range(b-1):
        next_mat = [[0 for _ in range(n)] for _ in range(n)]
        for i in range(n):
            for j in range(n):
                for k in range(n):
                    next_mat[i][j] += new_mat[i][k] * matrix[k][j]
                next_mat[i][j] %= 1000
        new_mat = next_mat
    
    return new_mat

new_mat = pow_mat(mat, n, b)
for row in new_mat:
    print(*row)
```

#### Result 1

- **ê²°ê³¼: ì‹œê°„ ì´ˆê³¼ ğŸ˜­**
- Bê°€ ìµœëŒ€ 1000ì–µì´ë¯€ë¡œ, ì‹œê°„ ë³µì¡ë„ê°€ O(NÂ³ * B)ê°€ ë˜ì–´ ë‹¹ì—°íˆ ì‹œê°„ ì´ˆê³¼ê°€ ë°œìƒí–ˆë‹¤.

---

#### Idea 2: ë¶„í•  ì •ë³µ ì ìš©

ì¼ë°˜ì ì¸ ê±°ë“­ì œê³± ìˆ˜ë¥¼ êµ¬í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë¶„í•  ì •ë³µ(Exponentiation by Squaring) ì›ë¦¬ë¥¼ í–‰ë ¬ ê³±ì…ˆì— ì ìš©í•˜ê¸°ë¡œ í–ˆë‹¤.

- `A^B`ëŠ” `A^(B/2) * A^(B/2)`ì™€ ê°™ë‹¤.
- ë§Œì•½ Bê°€ í™€ìˆ˜ë¼ë©´, `A^(B/2) * A^(B/2) * A`ê°€ ëœë‹¤.

ì´ ì›ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ ì ìš©í•˜ë©´ Bë²ˆì˜ ê³±ì…ˆì„ logBë²ˆìœ¼ë¡œ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

1.  **ì¬ê·€ ê¸°ë³¸ ë‹¨ê³„:** Bê°€ 1ì´ë©´ í–‰ë ¬ Aë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜í•œë‹¤.
2.  **ë¶„í• :** `pow_mat(A, B/2)`ë¥¼ ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•˜ì—¬ `A^(B/2)`ë¥¼ êµ¬í•œë‹¤.
3.  **ì •ë³µ:** 2ì—ì„œ êµ¬í•œ ê²°ê³¼ë¥¼ ìê¸° ìì‹ ê³¼ ê³±í•˜ì—¬ `A^B` (Bê°€ ì§ìˆ˜ì¼ ë•Œ) ë˜ëŠ” `A^(B-1)` (Bê°€ í™€ìˆ˜ì¼ ë•Œ)ë¥¼ ê³„ì‚°í•œë‹¤.
4.  **ì¡°ì •:** Bê°€ í™€ìˆ˜ì´ë©´, 3ì˜ ê²°ê³¼ì— Aë¥¼ í•œ ë²ˆ ë” ê³±í•´ì¤€ë‹¤.

#### Code 2

```python
import sys

sys.setrecursionlimit(30000000)

n, b = map(int, sys.stdin.readline().split())
mat = [list(map(lambda x: int(x) % 1000, sys.stdin.readline().split())) for _ in range(n)]

def mul_mat(matrix1:list[list], matrix2:list[list], n):
    result = [[0 for _ in range(n)] for _ in range(n)]
    for i in range(n):
        for j in range(n):
            for k in range(n):
                result[i][j] += matrix1[i][k] * matrix2[k][j]
            result[i][j] %= 1000
    return result

def pow_mat(matrix:list[list], n, b):
    if b == 1:
        return matrix

    # ê¸°ë³¸ ê±°ë“­ì œê³± ë¡œì§
    result = pow_mat(matrix, n, b // 2)
    result = mul_mat(result, result, n)

    # ë§Œì•½ í™€ìˆ˜ë©´ ê³±í•˜ê¸° ê¸°ë³¸ í–‰ë ¬ ì¶”ê°€
    if b % 2 == 1:
        result = mul_mat(result, matrix, n)
    
    return result

new_mat = pow_mat(mat, n, b)
for row in new_mat:
    print(*row)
```

#### Result 2

- **ê²°ê³¼: ì„±ê³µ!** ğŸ‰
- ì‹œê°„ ë³µì¡ë„ê°€ O(NÂ³ * logB)ë¡œ í¬ê²Œ ì¤„ì–´ë“¤ì–´ ì‹œê°„ ë‚´ì— ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.

---

## ë°°ìš´ ì  ë° ê°œì„ í•  ë¶€ë¶„ ğŸ¤”

- **ê±°ë“­ì œê³±ì˜ ë¶„í•  ì •ë³µ:** ì§€ìˆ˜ê°€ ë§¤ìš° í´ ê²½ìš°, ë¶„í•  ì •ë³µì„ ì´ìš©í•œ ê±°ë“­ì œê³±ì€ í•„ìˆ˜ì ì¸ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ì´ ì›ë¦¬ê°€ ì¼ë°˜ ìˆ«ìë¿ë§Œ ì•„ë‹ˆë¼ í–‰ë ¬ ê³±ì…ˆì—ë„ ë™ì¼í•˜ê²Œ ì ìš©ë  ìˆ˜ ìˆìŒì„ ë‹¤ì‹œ í•œë²ˆ í™•ì¸í–ˆë‹¤.
- **ëª¨ë“ˆëŸ¬ ì—°ì‚°ì˜ ìœ„ì¹˜:** ê³±ì…ˆê³¼ ë§ì…ˆ ì—°ì‚°ì´ ëˆ„ì ë  ë•Œ ìˆ˜ê°€ ë§¤ìš° ì»¤ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì¤‘ê°„ ê³„ì‚° ê³¼ì •ë§ˆë‹¤ ëª¨ë“ˆëŸ¬ ì—°ì‚°(`% 1000`)ì„ ì ìš©í•˜ì—¬ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ë°©ì§€í•˜ê³  ê³„ì‚°ëŸ‰ì„ ì¤„ì´ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.
- **ì¬ê·€ ê¹Šì´:** Pythonì—ì„œ ì¬ê·€ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” `sys.setrecursionlimit()`ì„ ì´ìš©í•´ ìµœëŒ€ ì¬ê·€ ê¹Šì´ë¥¼ ëŠ˜ë ¤ì£¼ì–´ì•¼ `RecursionError`ë¥¼ í”¼í•  ìˆ˜ ìˆë‹¤. ì´ ë¬¸ì œì—ì„œëŠ” Bê°€ í¬ì§€ë§Œ ì¬ê·€ ê¹Šì´ëŠ” logBì— ë¹„ë¡€í•˜ë¯€ë¡œ ì‚¬ì‹¤ ê¸°ë³¸ ì œí•œìœ¼ë¡œë„ ì¶©ë¶„í–ˆì„ ìˆ˜ ìˆë‹¤.

> Bê°€ 1000ì–µ? 'ì´ê±¸ ì–´ë–»ê²Œ ë‹¤ ê³±í•˜ì§€?' ë¼ëŠ” ìƒê°ì´ ë“¤ë©´, ë¶„í•  ì •ë³µì„ ë– ì˜¬ë¦¬ì.

<div style="text-align: center">â‚</div>
