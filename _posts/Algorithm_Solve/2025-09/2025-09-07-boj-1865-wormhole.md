---
layout: post
title:  "[ë°±ì¤€] 1865: ì›œí™€"
date:   2025-09-07 10:00:00 +0900
categories: Algorithm_Solve
tags: [algorithm, shortest-path, bellman-ford, floyd-warshall]
---

<br>

### ğŸ’» ë°±ì¤€ 1865ë²ˆ: ì›œí™€

- **ë¬¸ì œ ë§í¬:** [https://www.acmicpc.net/problem/1865](https://www.acmicpc.net/problem/1865)
- **ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜:** ìµœë‹¨ ê²½ë¡œ, ë²¨ë§Œ-í¬ë“œ

## ë¬¸ì œ ì†Œê°œ ğŸ§

Nê°œì˜ ì§€ì , Mê°œì˜ ë„ë¡œ, Wê°œì˜ ì›œí™€ì´ ìˆë‹¤. ë„ë¡œëŠ” ì–‘ë°©í–¥ì´ë©° ì´ë™ ì‹œ ì‹œê°„ì´ ê±¸ë¦¬ì§€ë§Œ, ì›œí™€ì€ ë‹¨ë°©í–¥ì´ë©° í†µê³¼ ì‹œ ì‹œê°„ì´ ê±°ê¾¸ë¡œ ê°„ë‹¤.

í•œ ì§€ì ì—ì„œ ì¶œë°œí•˜ì—¬ ë‹¤ì‹œ ì¶œë°œ ìœ„ì¹˜ë¡œ ëŒì•„ì™”ì„ ë•Œ, ì‹œê°„ì´ ì¶œë°œ ì‹œì ë³´ë‹¤ ì´ì „ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ê²½ìš°(ìŒìˆ˜ ì‚¬ì´í´)ê°€ ì¡´ì¬í•˜ëŠ”ì§€ íŒë³„í•˜ëŠ” ë¬¸ì œë‹¤.

### ì…ë ¥ ğŸ“

- ì²«ì§¸ ì¤„: í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ìˆ˜ TC
- ê° í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ì²«ì§¸ ì¤„: ì§€ì  ìˆ˜ N, ë„ë¡œ ìˆ˜ M, ì›œí™€ ìˆ˜ W
- ë„ë¡œ ì •ë³´(Mê°œ): S, E, T (S-E ì—°ê²°, ì‹œê°„ T ì†Œìš”)
- ì›œí™€ ì •ë³´(Wê°œ): S, E, T (S->E ì´ë™, ì‹œê°„ T ê°ì†Œ)

### ì¶œë ¥ ğŸ“¤

- ì‹œê°„ì´ ì¤„ì–´ë“¤ë©´ì„œ ì¶œë°œ ìœ„ì¹˜ë¡œ ëŒì•„ì˜¤ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë©´ `YES`, ë¶ˆê°€ëŠ¥í•˜ë©´ `NO`ë¥¼ ì¶œë ¥í•œë‹¤.

---

### ë‚˜ì˜ í’€ì´ âœ¨

ìŒìˆ˜ ê°€ì¤‘ì¹˜ë¥¼ í¬í•¨í•œ ê·¸ë˜í”„ì—ì„œ ìŒìˆ˜ ì‚¬ì´í´ì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ ì°¾ëŠ” ì „í˜•ì ì¸ ë¬¸ì œë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ìµœë‹¨ ê²½ë¡œ ì•Œê³ ë¦¬ì¦˜ì„ ì‹œë„í–ˆë‹¤.

#### Idea 1: í”Œë¡œì´ë“œ-ì›Œì…œ

ëª¨ë“  ì§€ì  ìŒ ê°„ì˜ ìµœë‹¨ ê²½ë¡œë¥¼ êµ¬í•˜ëŠ” í”Œë¡œì´ë“œ-ì›Œì…œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•´ë³´ê¸°ë¡œ í–ˆë‹¤. ì•Œê³ ë¦¬ì¦˜ì„ ì‹¤í–‰í•œ í›„, `path[i][i]` (iì—ì„œ ì‹œì‘í•´ ië¡œ ëŒì•„ì˜¤ëŠ” ê²½ë¡œ)ì˜ ê°’ì´ ìŒìˆ˜ì´ë©´ ìŒìˆ˜ ì‚¬ì´í´ì´ ì¡´ì¬í•œë‹¤ê³  íŒë‹¨í•  ìˆ˜ ìˆë‹¤.

##### Code

```python
import sys

TC = int(sys.stdin.readline().rstrip())

def floyd_warshall(graph, n):
    path = [row[:] for row in graph]
    for k in range(1, n+1):
        for i in range(1, n+1):
            for j in range(1, n+1):
                path[i][j] = min(path[i][j], path[i][k] + path[k][j])
    return path

for _ in range(TC):
    n, m, w = map(int, sys.stdin.readline().split())
    graph = [[float('inf')]*(n+1) for _ in range(n+1)]
    for _ in range(m):
        s, e, t = map(int, sys.stdin.readline().split())
        graph[s][e] = min(graph[s][e], t)
        graph[e][s] = min(graph[e][s], t)
    
    for _ in range(w):
        s, e, t = map(int, sys.stdin.readline().split())
        graph[s][e] = min(graph[s][e], -1*t)

    for i in range(1,n+1):
        graph[i][i] = 0
    
    shortest_paths = floyd_warshall(graph, n)

    is_time_travel = False
    for i in range(1, n+1):
        if shortest_paths[i][i] < 0:
            is_time_travel = True
            break
    
    print("YES") if is_time_travel else print("NO")
```

##### Result: ì‹œê°„ ì´ˆê³¼

í”Œë¡œì´ë“œ-ì›Œì…œì˜ ì‹œê°„ ë³µì¡ë„ëŠ” `O(NÂ³)`ì´ë‹¤. Nì´ ìµœëŒ€ 500ì´ë¯€ë¡œ, 500Â³ì€ ì•½ 1ì–µ 2500ë§Œìœ¼ë¡œ ì‹œê°„ ì œí•œ(2ì´ˆ)ì„ ì´ˆê³¼í•  ìˆ˜ë°–ì— ì—†ì—ˆë‹¤. ìŒìˆ˜ ì‚¬ì´í´ íŒë³„ì— ë” íš¨ìœ¨ì ì¸ ì•Œê³ ë¦¬ì¦˜ì´ í•„ìš”í–ˆë‹¤.

#### Idea 2: ë²¨ë§Œ-í¬ë“œ (ëª¨ë“  ë…¸ë“œì—ì„œ ì‹œì‘)

ìŒìˆ˜ ê°€ì¤‘ì¹˜ ê·¸ë˜í”„ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ë²¨ë§Œ-í¬ë“œ ì•Œê³ ë¦¬ì¦˜`(O(VE))`ì„ ì‚¬ìš©í•˜ê¸°ë¡œ í–ˆë‹¤. ë²¨ë§Œ-í¬ë“œëŠ” V-1ë²ˆì˜ ì™„í™”(relaxation) í›„, Vë²ˆì§¸ ì™„í™”ì—ì„œ ë˜ ê±°ë¦¬ê°€ ê°±ì‹ ë˜ë©´ ìŒìˆ˜ ì‚¬ì´í´ì´ ì¡´ì¬í•œë‹¤ê³  íŒë‹¨í•œë‹¤. 

ê·¸ë˜í”„ê°€ ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ë¡œ ë‚˜ë‰˜ì–´ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ëª¨ë“  ë…¸ë“œë¥¼ ì‹œì‘ì ìœ¼ë¡œ í•˜ì—¬ ë²¨ë§Œ-í¬ë“œë¥¼ ì‹¤í–‰í–ˆë‹¤.

##### Code

```python
import sys

TC = int(sys.stdin.readline().rstrip())

def bellmanFord(graph_edges, n, start):
    dist = [float('inf')] * (n+1)
    dist[start] = 0

    for i in range(1, n):
        for u, v, w in graph_edges:
            if dist[u] != float('inf') and dist[u] + w < dist[v]:
                dist[v] = dist[u] + w

    for u, v, w in graph_edges:
        if dist[u] != float('inf') and dist[u] + w < dist[v]:
            return dist, True
    
    return dist, False

for _ in range(TC):
    n, m, w = map(int, sys.stdin.readline().split())
    edge_list = []
    # ... (ì´ì „ê³¼ ë™ì¼)
    
    has_cycle = False
    for i in range(1, n+1):
        shortest_paths, has_cycle = bellmanFord(edge_list, n, i)
        if has_cycle:
            break
    
    print("YES") if has_cycle else print("NO")
```

##### Result: 67% ì‹œê°„ ì´ˆê³¼

ëª¨ë“  ë…¸ë“œ(Nê°œ)ì— ëŒ€í•´ ë²¨ë§Œ-í¬ë“œ`(O(VE))`ë¥¼ ì‹¤í–‰í•˜ë‹ˆ ì‹œê°„ ë³µì¡ë„ëŠ” `O(N*VE)`ê°€ ë˜ì–´ ì—¬ì „íˆ ì‹œê°„ ì´ˆê³¼ê°€ ë°œìƒí–ˆë‹¤. í•œ ë²ˆì˜ ë²¨ë§Œ-í¬ë“œ ì‹¤í–‰ìœ¼ë¡œ ì „ì²´ ê·¸ë˜í”„ì˜ ìŒìˆ˜ ì‚¬ì´í´ì„ ê°ì§€í•  ë°©ë²•ì´ í•„ìš”í–ˆë‹¤.

#### Idea 3: ë²¨ë§Œ-í¬ë“œ + ê°€ìƒ ì‹œì‘ì 

ëª¨ë“  ë…¸ë“œì™€ ì—°ê²°ëœ ê°€ìƒì˜ ì‹œì‘ ë…¸ë“œ(0ë²ˆ)ë¥¼ ë§Œë“¤ê³ , ì´ ë…¸ë“œì—ì„œ ê° ì‹¤ì œ ë…¸ë“œ(1~N)ë¡œ ê°€ëŠ” ê°€ì¤‘ì¹˜ 0ì˜ ê°„ì„ ì„ ì¶”ê°€í–ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ê·¸ë˜í”„ê°€ ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ë¡œ ë‚˜ë‰˜ì–´ ìˆë”ë¼ë„, ê°€ìƒ ë…¸ë“œì—ì„œ ì¶œë°œí•˜ëŠ” í•œ ë²ˆì˜ ë²¨ë§Œ-í¬ë“œ ì‹¤í–‰ë§Œìœ¼ë¡œ ëª¨ë“  ë…¸ë“œë¥¼ ë°©ë¬¸í•˜ê³  ì „ì²´ ê·¸ë˜í”„ì˜ ìŒìˆ˜ ì‚¬ì´í´ ì¡´ì¬ ì—¬ë¶€ë¥¼ íŒë³„í•  ìˆ˜ ìˆë‹¤.

##### Code

```python
import sys

TC = int(sys.stdin.readline().rstrip())

def bellmanFord(graph_edges, n, start):
    dist = [float('inf')] * (n+1)
    dist[start] = 0

    for _ in range(0, n):
        for u, v, w in graph_edges:
            if dist[u] != float('inf') and dist[u] + w < dist[v]:
                dist[v] = dist[u] + w

    for u, v, w in graph_edges:
        if dist[u] != float('inf') and dist[u] + w < dist[v]:
            return dist, True
    
    return dist, False

for _ in range(TC):
    n, m, w = map(int, sys.stdin.readline().split())
    edge_list = []
    # ... (ì´ì „ê³¼ ë™ì¼)
    
    # ê°€ìƒì˜ ë…¸ë“œ ì¶”ê°€
    for i in range(1, n+1):
        edge_list.append((0, i, 0))
    
    shortest_paths, has_cycle = bellmanFord(edge_list, n, 0)
    
    print("YES") if has_cycle else print("NO")
```

##### Result: ì„±ê³µ! ğŸ‰

ì´ ë°©ë²•ì€ `O(VE)`ì˜ ì‹œê°„ ë³µì¡ë„ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.

---

## ë§ˆë¬´ë¦¬ ğŸ¤”

- **ì•Œê³ ë¦¬ì¦˜ ì„ íƒì˜ ì¤‘ìš”ì„±:** ë¬¸ì œì˜ ì œì•½ ì¡°ê±´(N, M, Wì˜ í¬ê¸°)ì„ ë³´ê³  O(NÂ³)ì¸ í”Œë¡œì´ë“œ-ì›Œì…œì´ ì•„ë‹Œ O(VE)ì¸ ë²¨ë§Œ-í¬ë“œë¥¼ ì„ íƒí•´ì•¼ í–ˆë‹¤.
- **ì—°ê²°ë˜ì§€ ì•Šì€ ê·¸ë˜í”„ ì²˜ë¦¬:** ê·¸ë˜í”„ê°€ ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ë¡œ ë‚˜ë‰˜ì–´ ìˆì„ ê²½ìš°, ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ íƒìƒ‰í•˜ê¸° ìœ„í•´ ê°€ìƒì˜ ì‹œì‘ ë…¸ë“œë¥¼ ì¶”ê°€í•˜ëŠ” íŠ¸ë¦­ì€ ë§¤ìš° ìœ ìš©í•˜ë‹¤.
- **ë²¨ë§Œ-í¬ë“œì˜ ì›ë¦¬:** V-1ë²ˆì˜ ì™„í™”ë¡œ ëª¨ë“  ìµœë‹¨ ê²½ë¡œë¥¼ ì°¾ê³ , Vë²ˆì§¸ ì™„í™”ì—ì„œ ê°±ì‹ ì´ ì¼ì–´ë‚œë‹¤ë©´ ìŒìˆ˜ ì‚¬ì´í´ì´ ì¡´ì¬í•œë‹¤ëŠ” ë²¨ë§Œ-í¬ë“œì˜ í•µì‹¬ ì›ë¦¬ë¥¼ ì •í™•íˆ ì´í•´í•˜ê³  ì ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í–ˆë‹¤.

> ì‹œê°„ ì´ˆê³¼ë¥¼ í†µí•´ ë” íš¨ìœ¨ì ì¸ ì•Œê³ ë¦¬ì¦˜ì„ ê³ ë¯¼í•˜ê³ , ë¬¸ì œ ìƒí™©ì— ë§ê²Œ ì•Œê³ ë¦¬ì¦˜ì„ ë³€í˜•(ê°€ìƒ ë…¸ë“œ ì¶”ê°€)í•˜ëŠ” ì¢‹ì€ ê²½í—˜ì´ì—ˆë‹¤.

<div style="text-align: center">â‚</div>
