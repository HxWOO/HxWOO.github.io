---
layout: post
title:  "[ë°±ì¤€] 7662: ì´ì¤‘ ìš°ì„ ìˆœìœ„ í"
date:   2025-07-24 00:00:00 +0900
categories: Algorithm_Solve
tags: [algorithm, priority-queue, heap]
---

<br>

### ğŸ’» ë°±ì¤€ 7662: ì´ì¤‘ ìš°ì„ ìˆœìœ„ í

- **ë¬¸ì œ ë§í¬:** [https://www.acmicpc.net/problem/7662](https://www.acmicpc.net/problem/7662)
- **ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜:** ìë£Œ êµ¬ì¡°, ìš°ì„ ìˆœìœ„ í


## ë¬¸ì œ ì†Œê°œ ğŸ§

ì´ì¤‘ ìš°ì„ ìˆœìœ„ íëŠ” ë°ì´í„°ë¥¼ ì‚½ì…, ì‚­ì œí•  ìˆ˜ ìˆëŠ” ìë£Œ êµ¬ì¡°ì…ë‹ˆë‹¤. ì¼ë°˜ì ì¸ ìš°ì„ ìˆœìœ„ íì™€ ë‹¬ë¦¬, ì‚­ì œ ì—°ì‚° ì‹œ ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ë°ì´í„° ë˜ëŠ” ê°€ì¥ ë‚®ì€ ë°ì´í„° ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì—¬ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì£¼ì–´ì§„ ì—°ì‚°ë“¤ì„ ì²˜ë¦¬í•œ í›„, íì— ìµœì¢…ì ìœ¼ë¡œ ë‚¨ì•„ìˆëŠ” ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì„ ì¶œë ¥í•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤.

### ì…ë ¥ ğŸ“

- ì²«ì§¸ ì¤„: í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ìˆ˜ T
- ê° í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ì²«ì§¸ ì¤„: ì—°ì‚°ì˜ ê°œìˆ˜ k (k â‰¤ 1,000,000)
- ì´í›„ kê°œì˜ ì¤„: ì—°ì‚°ì„ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ì(â€˜Dâ€™ ë˜ëŠ” â€˜Iâ€™)ì™€ ì •ìˆ˜ n
    - `I n`: ì •ìˆ˜ nì„ íì— ì‚½ì…
    - `D 1`: íì—ì„œ ìµœëŒ“ê°’ì„ ì‚­ì œ
    - `D -1`: íì—ì„œ ìµœì†Ÿê°’ì„ ì‚­ì œ

### ì¶œë ¥ ğŸ“¤

- ëª¨ë“  ì—°ì‚° ì²˜ë¦¬ í›„ íì— ë‚¨ì€ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì„ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì¶œë ¥
- íê°€ ë¹„ì–´ìˆìœ¼ë©´ "EMPTY"ë¥¼ ì¶œë ¥

### ì œí•œ âŒ

- **ì‹œê°„:** 6ì´ˆ
- **ë©”ëª¨ë¦¬:** 256MB
- **ì •ìˆ˜ ë²”ìœ„:** -2^31 ì´ìƒ 2^31 ë¯¸ë§Œ


### ì²« ë²ˆì§¸ ì‹œë„: PriorityQueue ì‚¬ìš© ğŸ‘Š

#### Idea

`PriorityQueue`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìµœì†Œ í™(min-heap)ìœ¼ë¡œ ë™ì‘í•˜ë¯€ë¡œ `get()` ë©”ì„œë“œëŠ” í•­ìƒ ìµœì†Ÿê°’ì„ ë°˜í™˜í•œë‹¤. ìµœëŒ“ê°’ì„ ì‚­ì œí•˜ê¸° ìœ„í•´ `end` ì¸ë±ìŠ¤ë§Œ ë”°ë¡œ ê´€ë¦¬í•˜ì—¬ ì²˜ë¦¬í•´ë³´ë©´ ì–´ë–¨ê¹Œ ìƒê°í–ˆë‹¤.

#### Code

```python
import sys
from collections import deque
from queue import PriorityQueue

t = int(sys.stdin.readline().rstrip())  # ì…ë ¥ ë°ì´í„°ì˜ ìˆ˜

while t:
# I ëŠ” insert, D 1ì€ ìµœëŒ“ê°’ pop, D -1ì€ ìµœì†Ÿê°’ pop
    k = int(sys.stdin.readline().rstrip())  # ì—°ì‚°ì˜ ìˆ˜
    Q = PriorityQueue()
    end = 0

    for _ in range(k):
        a, b = sys.stdin.readline().split()
        b = int(b)

        if a == 'I':
            Q.put(b)
            end += 1

        if a == 'D':
            if not end:  # ë ì¸ë±ìŠ¤ê°€ 0ì¼ë•Œ
                continue
            else:
                if b == -1:
                    Q.get()
                    end -= 1
                else:
                    end -= 1
    t-=1
    if end:
        min_Q = Q.get()
        max_Q = min_Q
        for i in range(end):
            max_Q = Q.get()
        print(max_Q, min_Q)
    else:
        print('EMPTY')
```

#### Result

- **í‹€ë ¸ìŠµë‹ˆë‹¤**
- `PriorityQueue`ì—ì„œ ì„ì˜ì˜ (ìµœëŒ€) ì›ì†Œë¥¼ ì œê±°í•˜ëŠ” ë¡œì§ì´ ì˜ëª»ë˜ì—ˆë‹¤. `get()`ì€ í•­ìƒ ìµœì†Ÿê°’ë§Œ ì œê±°í•˜ë¯€ë¡œ, ìµœëŒ“ê°’ì„ ì§ì ‘ ì œê±°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### ë‘ ë²ˆì§¸ ì‹œë„: Listì™€ ì¸ë±ìŠ¤ ì¹´ìš´íŒ… âœ¨

#### Idea

`list`ì— ëª¨ë“  ì›ì†Œë¥¼ ì €ì¥í•˜ê³ , ìµœì†Ÿê°’/ìµœëŒ“ê°’ ì‚­ì œ ì—°ì‚°ì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ ì‹¤ì œë¡œ `pop`í•˜ì§€ ì•Šê³  ì¹´ìš´íŠ¸ë§Œ í•œë‹¤. ëª¨ë“  ì—°ì‚°ì´ ëë‚œ í›„ ë¦¬ìŠ¤íŠ¸ë¥¼ ì •ë ¬í•˜ê³ , ì¹´ìš´íŠ¸ëœ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•´ ìµœì¢… ìµœì†Ÿê°’ê³¼ ìµœëŒ“ê°’ì„ êµ¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•´ë³´ë ¤ í–ˆë‹¤.

#### Code

```python
import sys
from collections import deque
from queue import PriorityQueue

t = int(sys.stdin.readline().rstrip())  # ì…ë ¥ ë°ì´í„°ì˜ ìˆ˜

while t:
# I ëŠ” insert, D 1ì€ ìµœëŒ“ê°’ pop, D -1ì€ ìµœì†Ÿê°’ pop
    k = int(sys.stdin.readline().rstrip())  # ì—°ì‚°ì˜ ìˆ˜
    Q = list()
    min_pop, max_pop = 0, 0
    length = 0

    for _ in range(k):
        a, b = sys.stdin.readline().split()
        b = int(b)

        if a == 'I':
            Q.append(b)
            length += 1

        if a == 'D':
            if not length:
                continue
            if b == -1:
                min_pop += 1
            else:
                max_pop -= 1
            
            length -= 1
    t-=1
    if length > 0:
        Q.sort()
        print(Q[-1 + max_pop], Q[min_pop])
    else:
        print('EMPTY')
```

#### Result

- **ì‹¤íŒ¨**
- ì¤‘ê°„ì— ì–´ë–¤ ê°’ì´ ì‚­ì œë˜ì—ˆëŠ”ì§€ ì¶”ì í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, ë§ˆì§€ë§‰ì— ì •ë ¬í•˜ë”ë¼ë„ ì´ë¯¸ ì‚­ì œëœ ê°’ì´ ìµœì†Ÿê°’/ìµœëŒ“ê°’ìœ¼ë¡œ ì˜ëª» ì„ íƒë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë’¤ëŠ¦ê²Œ ì•Œì•„ì±˜ë‹¤.

### ì„¸ ë²ˆì§¸ ì‹œë„: ìµœì†Œ í™ê³¼ ìµœëŒ€ í™ ë™ê¸°í™” âœ…

#### Idea

ìµœì†Œ í™ê³¼ ìµœëŒ€ í™, ë‘ ê°œì˜ ìš°ì„ ìˆœìœ„ íë¥¼ ë™ì‹œì— ì‚¬ìš©í•©ë‹ˆë‹¤.
1.  **ì‚½ì…**: ì›ì†Œë¥¼ ìµœì†Œ í™ì— ê·¸ëŒ€ë¡œ, ìµœëŒ€ í™ì—ëŠ” ë¶€í˜¸ë¥¼ ë°”ê¿”ì„œ ì‚½ì…í•©ë‹ˆë‹¤.
2.  **ì‚­ì œ**:
    -   **ìµœì†Ÿê°’ ì‚­ì œ**: ìµœì†Œ í™ì—ì„œ ì›ì†Œë¥¼ `pop`í•©ë‹ˆë‹¤.
    -   **ìµœëŒ“ê°’ ì‚­ì œ**: ìµœëŒ€ í™ì—ì„œ ì›ì†Œë¥¼ `pop`í•©ë‹ˆë‹¤.
3.  **ë™ê¸°í™”**: í•œìª½ í™ì—ì„œ ì‚­ì œëœ ì›ì†Œê°€ ë‹¤ë¥¸ ìª½ í™ì—ëŠ” ì—¬ì „íˆ ë‚¨ì•„ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ì´ë¥¼ 'ìœ ë ¹ ë°ì´í„°'ë¼ ì¹­í•¨). ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´, ê° ìˆ«ìì˜ ê°œìˆ˜ë¥¼ `dict`ì— ì €ì¥í•©ë‹ˆë‹¤. `pop`ì„ ìˆ˜í–‰í•  ë•Œ, í•´ë‹¹ ì›ì†Œì˜ ê°œìˆ˜ê°€ 0ì´ë¼ë©´ ì´ë¯¸ ë‹¤ë¥¸ í™ì—ì„œ ì‚­ì œëœ ê²ƒì´ë¯€ë¡œ, ìœ íš¨í•œ ì›ì†Œê°€ ë‚˜ì˜¬ ë•Œê¹Œì§€ ê³„ì† `pop`í•˜ì—¬ ìœ ë ¹ ë°ì´í„°ë¥¼ ì œê±°í•©ë‹ˆë‹¤.

#### Code

```python
import sys
import heapq

t = int(sys.stdin.readline())

for _ in range(t):
    k = int(sys.stdin.readline())
    min_heap, max_heap = [], []
    counts = dict()

    for _ in range(k):
        op, n_str = sys.stdin.readline().split()
        n = int(n_str)

        if op == 'I':
            heapq.heappush(min_heap, n)
            heapq.heappush(max_heap, -n)
            counts[n] = counts.get(n, 0) + 1
        
        elif n == 1: # ìµœëŒ“ê°’ ì‚­ì œ
            # ë¨¼ì € ìœ ë ¹ ë°ì´í„°ë“¤ì„ ëª¨ë‘ ì œê±°
            while max_heap and counts.get(-max_heap[0], 0) == 0:
                heapq.heappop(max_heap)
            
            if max_heap:
                removed = -heapq.heappop(max_heap)
                counts[removed] -= 1
        
        else: # ìµœì†Ÿê°’ ì‚­ì œ
            # ë¨¼ì € ìœ ë ¹ ë°ì´í„°ë“¤ì„ ëª¨ë‘ ì œê±°
            while min_heap and counts.get(min_heap[0], 0) == 0:
                heapq.heappop(min_heap)
            if min_heap:
                removed = heapq.heappop(min_heap)
                counts[removed] -= 1
                
    # ëª¨ë“  ì—°ì‚° í›„, ìµœì¢…ì ìœ¼ë¡œ í™ì— ë‚¨ì€ ìœ ë ¹ ë°ì´í„°ë“¤ì„ ì •ë¦¬
    while max_heap and counts.get(-max_heap[0], 0) == 0:
        heapq.heappop(max_heap)
    while min_heap and counts.get(min_heap[0], 0) == 0:
        heapq.heappop(min_heap)
        
    if not max_heap or not min_heap:
        print("EMPTY")
    else:
        print(-max_heap[0], min_heap[0])
```

#### Result

- **ì„±ê³µ**
- ë‘ ê°œì˜ í™ê³¼ `dict`ë¥¼ ì´ìš©í•´ ìƒíƒœë¥¼ ë™ê¸°í™”í•˜ëŠ” ì „ëµì´ í†µí–ˆë‹¤. í—ˆìƒ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì´ í•µì‹¬ì´ì—ˆë‹¤.

## ê°œì„ í•  ë¶€ë¶„ ğŸ¤”

- ê° í™ì˜ ìƒíƒœë¥¼ ë™ê¸°í™”í•˜ëŠ” ë¡œì§ì„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.